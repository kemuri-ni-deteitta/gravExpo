title: Certificates Page
'@extends':
    type: default
    context: blueprints://pages

form:
  fields:
    tabs:
      type: tabs
      active: 1
      fields:
        content:
          type: tab
          title: PLUGIN_ADMIN.CONTENT
          fields:
            header.title:
              type: text
              autofocus: true
              style: vertical
              label: PLUGIN_ADMIN.TITLE
              
            header.menu:
              type: text
              label: PLUGIN_ADMIN.MENU
              help: PLUGIN_ADMIN.MENU_HELP
              
            content:
              type: editor
              label: PLUGIN_ADMIN.CONTENT
              help: Описание страницы сертификатов
              
        certificates:
          type: tab
          title: Сертификаты
          fields:
            header.certificates:
              type: list
              style: vertical
              label: Список сертификатов
              help: Добавьте сертификаты с изображениями и описаниями
              collapsed: false
              btnLabel: Добавить сертификат
              fields:
                .title:
                  type: text
                  label: Название сертификата
                  placeholder: Введите название сертификата
                  validate:
                    required: true
                .image_upload:
                  type: file
                  label: Загрузить новое изображение
                  destination: 'user/pages/02.o-kompanii/04.sertifikaty'
                  multiple: false
                  random_name: false
                  avoid_overwriting: false
                  filesize: 2
                  accept:
                    - image/*
                  help: Загрузите изображение сертификата (JPEG, PNG, WebP). Максимальный размер 2MB.
                .image_name:
                  type: text
                  label: Имя файла изображения
                  placeholder: например, certificate1.jpg
                  help: Автоматически заполняется при загрузке файла выше, или введите имя существующего файла.
                .description:
                  type: textarea
                  label: Описание (необязательно)
                  placeholder: Краткое описание сертификата
                  rows: 3
            certificate_script:
              type: spacer
              title: ""
              markdown: true
              text: |
                <script>
                // Auto-fill image_name when file is uploaded
                document.addEventListener('DOMContentLoaded', function() {
                    setTimeout(function() {
                        const fileInputs = document.querySelectorAll('input[type="file"][name*="image_upload"]');
                        fileInputs.forEach(function(fileInput) {
                            fileInput.addEventListener('change', function(e) {
                                if (e.target.files && e.target.files[0]) {
                                    const filename = e.target.files[0].name;
                                    const container = e.target.closest('.form-field').parentNode;
                                    const imageNameInput = container.querySelector('input[name*="image_name"]');
                                    if (imageNameInput) {
                                        imageNameInput.value = filename;
                                        imageNameInput.dispatchEvent(new Event('input', { bubbles: true }));
                                    }
                                }
                            });
                        });
                    }, 1000);
                });
                </script> 